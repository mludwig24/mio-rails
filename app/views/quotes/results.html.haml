%h1
	= t('quote.results.headers.quote_results')


%div{"style" => "display: block"}
	- @rates.underwriters do |r|
		%pre
			= JSON.pretty_generate(r)
%div{"style" => "display: block"}
	- @rates.coverages do |r|
		%pre
			= JSON.pretty_generate(r)

%div.quote_results
	- @rates.underwriters.each do |u|
		%div{"class" => "col-lg-#{(12 / @rates.underwriters.count).floor} col-md-#{(12 / @rates.underwriters.count).floor} col-sm-12"}
			%h4
				%img{"src" => @rates.select { |r| r["underwriter_name"] == u }.first["underwriter_image"]}
				= u
			%hr
			- @rates.coverages.each do |c|
				%div{"class" => "col-lg-#{(12 / @rates.coverages.count).floor} col-md-#{(12 / @rates.coverages.count).floor} col-sm-6"}
					%h5
						= c
					%hr
					- @rates.select { |r| r["underwriter_name"] == u && r["underwriter_coverage_desc"] == c }.each do |r|
						%div.quote_result
							%span.term
								= t("quote.results.labels.#{r['term']}")
							%br
							%span.buy_now
								= number_to_currency(r["total_price"])
							%br.clear
							%a.btn.btn-success.btn-large{"href" => r["issue_link"]}
								= t('quote.results.buttons.buy_now')
							%br.clear
							%a.btn.btn-default{"href" => "#coverage"}
								= t('quote.results.buttons.details')
							%hr
%br.clear
%hr

%div{"style" => "display: none"}
	%ul
		- @rates.each do |r|
			%li
				%pre{"style" => "display: none"}
					= JSON.pretty_generate(r)
				%img{"src" => r["underwriter_image"]}
				%br
				%strong
					= r["underwriter_name"]
				%br
				%i
					= r["underwriter_coverage_desc"]
				%br
				%a{"href" => r["issue_link"]}
					= r["total_price"]

%pre{"style" => "display: none"}
	= JSON.pretty_generate(@rates.rates)

%pre{"style" => "display: none"}
	= JSON.pretty_generate(@rates.api_data)

%div{"style" => "display: none"}
	%h2
		= t('quote.form.header.edit_quote')
	= render "quote_form", :quote => @quote